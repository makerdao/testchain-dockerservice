language: elixir
elixir: '1.7'
otp_release: '21.1'
dist: xenial
services: docker
branches:
  only:
  - "/.*/"
before_install:
- docker pull nats:linux
- docker run -d -p 4222:4222 nats:linux
cache:
  directories:
  - deps
script:
- mix test
deploy:
- provider: script
  script:
    echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin &&
    make build TAG=dev &&
    make docker-push TAG=dev &&
  on:
    branch: add-dockerhub-credentials-to-travisyml
  skip_cleanup: true
notifications:
  webhooks:
    urls:
    - secure: qHhiKFev+Ua9vNOdPGU/Vxjix1GCp9cPSVsnx3zCI9A2vdHmgfAxbKhvB5989g06XqYHkp+4ACV1TWfcmP3X1+garHi3CxmZwoYMosJ8HdIvHG2skfmFeaSnLTqBgtVYXllGZ5VhgonV1srZo7VaopjkxSzyvcMHzpIxUjSjWY6Jn0qtTpVli9i4CNq/wdQC3JBBfiS13j+8jh/irUnKZ6BBdVnLCO+MQ8NvcIkv/QQcGIM2wzp7y73dKJ3gX14JFyJXjzw474bm/taN2Te5H9iR+ZbxxAu2ftVyaXAf2KHIeU4Zmdm4T220BqvhKzkAjMZ2Z1aHTPv3janSm4BiE2Az5i3Mu+o1PwCRyXilIDprdyPSSD3gmDnrXaWYTdOkxxGQWLQXWrTmp18Bp+/cV566bxGemH7QCpYC72IuWOl6qn9FZ4Z5MTVlgMvGyTXoQRtsOCjwkriBAcjIsGO5H+gpw8OTmryzvlxYF/LL3w3LoWxYzGB11LQrg6kCjOFuP/7kfu1sb0lZhz/zZQn9BxN3mS7dOnEC/QhmxlDjjqbF/dI0wPCk9Wd6y3pYxpfobRBT68Jhqz5zBr3LoKttu/F19XoT/RwPtW3vI7NS0lRTplXPgz30P2hO12f9YCrOi502zbF2aRC/AARIc0xdXyXOy0Qvw/SZ/hxZhB5chgc=
    on_failure: always
    on_success: never
env:
  global:
  - secure: I0HguS+WSEV8c/Mh1HkiHBO2Z2/tiEejUXTj039UrKISAC+ypTLXUurE5hKkYehDrf4p7J3Y1bizoMg3t2GtQfrvPHArCwvJnGup7J0wUC0Tq6kCbZ7OPqcVfgMhcJRCUPp9TGJ5P3WlAz8iV0cZSJsXStkmv9BHOMKLkKT4M/uvqm9EZbMzuM9FHq8J7x4EYXkKWuuMCnyAxGVxYmLtOURr8X1r+f+R8YSOXx4cK2gvFpvN4Gm0E2mqKaH/BcltsCOO38O/HMduJJSqTNnVLQcZ40+sngRsX+dkg3o8NjhACaAODJ4apL8WI8dxO64NbO7lH6R02/33lZSVSQhk8H9YOLniiZRBVsduEnprmKjxiq/iGpgK22XrWM3EWdRlu4mO5WzFyaP+67zIJ7/+Dv+7HklQFshM6DSmXIv6ioFL9LIDRFRuFeC2Ifra+VChr7j9cb6d8NcdNTkni/5stZfjbUqU9NrUUiYWxRo1Rj83PNM13mv1Pzgm1oFmG5LBULLxFhMgwN8f7qXfkS+VK7g09C2mG/gowWZxtydxtSMGcaE4Hi0LCdBqM2atq9gHZPK1HuGPSGS84nE5fhOU+a5YtAMCvvc9RWEWajjiZRSWOy61qicKkJYunybx8I1gXhlKsirCn46Y5LbtWMwYd3xsMy9KTlK+/+EGcSh0NAk=
  - secure: kkLD5MLbGUf8akKk/uQIMp2fXMCBQxlS5lIVYdVNPZyCnij6ZN9v+3Sk4NKEoyvB0P2SXD/+H+FvLHkDpWqG/nm7zzig8nCs3LQhVr8xtOjrrJ5atoPCVx9fGMwMRg4byU+9uq3h/A5XMw6ts5TPkpoJ/oA0uk6Xyf8E1rfeCdW5VpYklM4eYa4j+QiOmmsHzY/eHekx2ZxUeYj67UDK70mgqF9S7Fsd7RFb3xTjoiNURUljT7dJ+4a6SqOeYln7KLPfGBr3zVyJsOcClpIgqVfWDqt7V/142n0aqWX9jJ8ugDdQgO9wegRISXYDL7d6Qzrz91kSxoaieYFCGCww1EJDAR1iSj1Wbt8IXiMe5sU5QuqqBYcB6qRlKG/1TUy+OSiWwM1o1eVXD36GdF+6l1wipAgOWqlJQ9ID/Utzsfk6z5tFQdeMmrulCLFGgulDPhEtwnI48KY9TNgCfatoVTmMVekfpd+pRRyfDurQg7eJOsaQpmk+nrtOuzeQmQmffwnaeAk7fLePWebMgLveA8F/eCsiqsP4Ju+q8T1Wcxs+0A9AUxkhVUJjKfm+x9M5LeJQynEjNYLRMRe6rJAc+lddb+QxxtiZ/wzbbqTw7H4l6LCFZ0CcDapTxcEDroZYmix/1wAsExyty4sSY2InBtIh59Xs6VZlkUYm8svgJT8=
